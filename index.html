<!DOCTYPE html>
<html>
<head>
  <style>
    canvas { background:#090; display:block; }
  </style>
</head>
<body>
<canvas id="c" width="1900" height="960"></canvas>
  
<script>
const canvas = document.getElementById('c');
const ctx = canvas.getContext('2d');
const keys = {
  ArrowLeft:  false,
  ArrowRight: false,
  ArrowUp:    true,
  ArrowDown:  false,
  KeyA:       false,
  KeyZ:       false,
//  Space:      false
};

window.addEventListener('keydown', e => {
  if (e.code in keys) {
    for (const keyName of Object.keys(keys)) {
      const value = keys[keyName]; // Access the value (true/false) using the key name
      if (e.code != keyName) keys[keyName] = false;  
    }
    keys[e.code] = true;
    e.preventDefault();               // stop page scroll etc.
  }
});
//window.addEventListener('keyup', e => {
//  if (e.code in keys) {
//    keys[e.code] = false;
//  }
//});

const player = {
  x: canvas.width / 2,
  y: canvas.height / 2,
  radius: 35,
  speed: 2   // pixels per second
};

// -------------------------------------------------
// 4. Animation loop
// -------------------------------------------------
let last = performance.now();

function loop(now) {
  const dt = (now - last) / 10;   // seconds
  last = now;
  // clear screen 
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  ctx.fillStyle = '#49f';

  // ---- read input inside the loop ----
  if (keys.ArrowLeft)  { player.x-=player.speed*dt; 
                        ctx.fillRect(player.x - player.radius*2, player.y - player.radius/2, player.radius, player.radius);}
  if (keys.ArrowRight) { player.x+=player.speed*dt; 
                        ctx.fillRect(player.x + player.radius,   player.y - player.radius/2, player.radius, player.radius);}
  if (keys.ArrowUp)    { player.y-=player.speed*dt; 
                        ctx.fillRect(player.x - player.radius/2, player.y - player.radius*2, player.radius, player.radius);}
  if (keys.ArrowDown)  { player.y+=player.speed*dt; 
                        ctx.fillRect(player.x - player.radius/2, player.y + player.radius,   player.radius, player.radius);}
//  if (keys.KeyA)  player.radius -= player.speed * dt / 10;
//  if (keys.KeyZ) player.radius += player.speed * dt / 10;
  if (keys.KeyA)  player.radius -= player.speed * player.radius * dt / 300;
  if (keys.KeyZ) player.radius += player.speed * player.radius * dt / 300;
  }

  // ---- keep inside canvas ----
//  player.x = Math.max(0, Math.min(canvas.width,  player.x));
//  player.y = Math.max(0, Math.min(canvas.height, player.y));
  if (player.x < 0) player.x = canvas.width;
  if (player.y < 0) player.y = canvas.height;
  if (player.x > canvas.width) player.x = 0;
  if (player.radius > 150) player.radius = 10;
  if (player.radius < 10) player.radius = 150;

  // ---- render ----
  ctx.fillStyle = '#fff';
  ctx.fillRect(player.x - player.radius, player.y - player.radius, player.radius *2, player.radius *2);
  if (keys.KeyZ) { ctx.fillStyle = '#49f';
     ctx.fillRect(player.x - player.radius/2, player.y - player.radius/2, player.radius, player.radius);}
  if (keys.KeyA) { ctx.fillStyle = '#f00';
     ctx.fillRect(player.x - player.radius/2, player.y - player.radius/2, player.radius, player.radius);}

  requestAnimationFrame(loop);
}

requestAnimationFrame(loop);
</script>
</body>
</html>
